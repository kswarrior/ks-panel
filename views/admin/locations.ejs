<%- include('../components/template') %>
<main id="content">
   <div class="bg-transparent">
      <div class="sm:flex sm:items-center px-8 pt-4">
         <div class="sm:flex-auto">
           <h1 class="text-base font-medium leading-6 text-white"><%= req.translations.location %></h1>
           <p class="mt-1 tracking-tight text-sm text-neutral-500"><%= req.translations.locationText %></p>
         </div>
      </div>

      <!-- Stats -->
      <div id="stats" class="grid grid-cols-1 md:grid-cols-2 gap-6 m-8">
        <div class="bg-white/5 rounded-xl p-6 shadow-lg">
          <h2 class="text-lg font-semibold text-white mb-2">Node Count</h2>
          <p class="text-4xl font-bold text-white"><%= nodeCount %></p>
        </div>
      </div>

      <div class="p-4 sm:p-6 lg:p-8 
              bg-transparent shadow-xl 
              border border-white/5 
              rounded-xl overflow-hidden 
              card 
              w-full max-w-4xl mx-auto">

        <form>

          <!-- Responsive Grid -->
          <div style="margin-bottom:75px;" class="grid grid-cols-1 md:grid-cols-2 gap-4">

            <!-- Name -->
            <div class="md:col-span-2">
              <label for="locationName" class="text-neutral-400 text-sm block mb-1">
                <%= req.translations.name %>:
              </label>
              <input id="locationName" value="<%= location.name %>" 
                class="rounded-xl text-white text-sm w-full px-4 py-2
                       bg-neutral-600/20 border border-white/5
                       placeholder:text-white/20 outline-none
                       hover:bg-white/5 focus:border-white/20"
                placeholder="Guwahati, Assam, IN">
            </div>

            <!-- Button -->
            <div class="md:col-span-2">
              <button id="updateButton" type="button"
                class="w-full rounded-xl <%= theme['button-color'] %> 
                       px-4 py-2 text-sm font-medium shadow-lg
                       transition hover:scale-[1.02] active:scale-95">
                <%= req.translations.saveChanges %>
              </button>
            </div>
          <br>
          </div>
         <br>
        </form>
      </div>
      
</main>
<script>

  document.getElementById('updateButton').addEventListener('click', function() {
    const name = document.getElementById('locationName').value;

    const locationData = {
      name
    };

    fetch('/location/<%= location.id %>', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(locationData)
    })
    .then(response => {
      if (response.ok) {
        return response.json();
      }
      throw new Error('Failed to update location');
    })
    .then(data => {
      console.log('Location updated:', data);
      window.location.href = '../admin/locations?err=EDITED'
    })
    .catch(error => {
  console.error(error);
  alert('Error updating location');
});
  });
</script>
