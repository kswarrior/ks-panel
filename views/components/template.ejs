<!doctype html>
<html lang="en" class="h-full w-full">
<head>
    <title><%= name %></title>
    <% if (logo == true) { %>
        <link rel="icon" href="/assets/logo.png" type="image/x-icon">
    <% } else { %>
        <link rel="icon" href="https://i.imgur.com/uvDunAR.png" type="image/x-icon">
    <% } %>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="<%= ogTitle %>" property="og:title">
    <meta content="<%= ogDescription %>" property="og:description">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg: #0a0a0a;
            --sidebar-bg: #101010;
            --header-bg: rgba(10, 10, 10, 0.92);
            --accent: #ffffff;
            --text: #f4f4f5;
            --text-muted: #a1a1aa;
            --border: rgba(255, 255, 255, 0.06);
            --hover: rgba(255, 255, 255, 0.07);
            --active-bg: rgba(255, 255, 255, 0.09);
            --radius: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Public Sans', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            height: 100vh;
            overflow: hidden;
            line-height: 1.5;
        }

        .layout {
            display: flex;
            height: 100vh;
            width: 100%;
        }

        /* ==================== SIDEBAR ==================== */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 260px;
            height: 100%;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border);
            z-index: 50;
            padding: 12px;
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: none;
            box-shadow: 4px 0 30px rgba(0, 0, 0, 0.4);
        }

        @media (min-width: 1024px) {
            .sidebar {
                display: block;
            }
        }

        .sidebar.right {
            left: auto;
            right: 0;
            border-right: none;
            border-left: 1px solid var(--border);
        }

        .sidebar-inner {
            height: 100%;
            display: flex;
            flex-direction: column;
            border-radius: var(--radius);
            background: var(--sidebar-bg);
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .sidebar.collapsed {
            width: 68px;
        }

        .logo-area {
            padding: 20px 24px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            white-space: nowrap;
        }

        .logo-img {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            flex-shrink: 0;
        }

        .logo-text {
            font-size: 21px;
            font-weight: 600;
            letter-spacing: -0.02em;
            color: var(--accent);
        }

        .sidebar.collapsed .logo-text,
        .sidebar.collapsed .user-name,
        .sidebar.collapsed .user-id,
        .sidebar.collapsed .nav-text {
            display: none;
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 20px;
            border-top: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
            background: rgba(255, 255, 255, 0.02);
        }

        .user-avatar {
            width: 34px;
            height: 34px;
            border-radius: 10px;
            flex-shrink: 0;
        }

        .user-info {
            flex: 1;
            min-width: 0;
        }

        .user-name {
            font-weight: 600;
            font-size: 14px;
            color: var(--text);
        }

        .user-id {
            font-size: 12px;
            color: var(--text-muted);
            font-family: monospace;
        }

        .nav-container {
            flex: 1;
            padding: 12px 8px;
            overflow-y: auto;
            position: relative;
        }

        .nav-list {
            list-style: none;
        }

        .active-bg {
            position: absolute;
            left: 8px;
            right: 8px;
            height: 42px;
            background: var(--active-bg);
            border-radius: 12px;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
        }

        .nav-item {
            position: relative;
            margin-bottom: 4px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 11px 20px;
            color: var(--text-muted);
            text-decoration: none;
            font-size: 14.5px;
            font-weight: 500;
            border-radius: 12px;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 2;
        }

        .nav-link:hover {
            color: var(--accent);
            background: var(--hover);
            transform: translateX(4px);
        }

        .nav-link.active {
            color: var(--accent);
            font-weight: 600;
            background: var(--active-bg);
        }

        .nav-link svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .admin-header {
            padding: 18px 20px 8px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
        }

        .logout {
            margin-top: auto;
            border-top: 1px solid var(--border);
            padding: 16px 20px;
            color: var(--text-muted);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 14px;
            font-size: 14.5px;
            font-weight: 500;
            transition: all 0.25s ease;
        }

        .logout:hover {
            color: #ff6b6b;
        }

        /* ==================== MAIN CONTENT AREA ==================== */
        .main-area {
            flex: 1;
            margin-left: 260px;
            transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .sidebar.collapsed + .main-area {
            margin-left: 68px;
        }

        .header {
            height: 68px;
            background: var(--header-bg);
            backdrop-filter: blur(16px);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            padding: 0 24px;
            gap: 20px;
            position: sticky;
            top: 0;
            z-index: 40;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .sidebar-toggle {
            width: 42px;
            height: 42px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid var(--border);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .sidebar-toggle:hover {
            background: var(--hover);
            transform: scale(1.08);
        }

        .search-box {
            flex: 1;
            max-width: 420px;
            position: relative;
        }

        .search-inner {
            display: flex;
            align-items: center;
            height: 44px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid var(--border);
            border-radius: 9999px;
            padding: 0 18px;
            transition: all 0.3s ease;
        }

        .search-inner:focus-within {
            border-color: rgba(255, 255, 255, 0.25);
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.08);
        }

        .search-inner svg {
            width: 19px;
            height: 19px;
            color: var(--text-muted);
            margin-right: 12px;
        }

        .search-input {
            background: transparent;
            border: none;
            outline: none;
            color: var(--text);
            font-size: 15px;
            width: 100%;
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .profile-area {
            margin-left: auto;
            position: relative;
        }

        .profile-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 6px 10px 6px 6px;
            border-radius: 9999px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            transition: all 0.25s ease;
        }

        .profile-btn:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .profile-avatar {
            width: 34px;
            height: 34px;
            border-radius: 10px;
        }

        .profile-name {
            font-weight: 600;
            font-size: 14.5px;
            color: var(--text);
        }

        .profile-id {
            font-size: 12px;
            color: var(--text-muted);
            font-family: monospace;
        }

        /* Dropdown */
        .profile-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 12px;
            width: 240px;
            background: #171717;
            border: 1px solid var(--border);
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            opacity: 0;
            transform: scale(0.95) translateY(-10px);
            pointer-events: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .profile-area:hover .profile-dropdown {
            opacity: 1;
            transform: scale(1) translateY(0);
            pointer-events: all;
        }

        .dropdown-inner {
            padding: 20px;
        }

        .lang-label {
            font-size: 13px;
            color: #888;
            margin-bottom: 8px;
            display: block;
        }

        .lang-select {
            width: 100%;
            background: #222;
            border: 1px solid #444;
            color: var(--text);
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 15px;
            outline: none;
            transition: all 0.2s;
        }

        .lang-select:focus {
            border-color: #666;
        }

        /* Loader */
        .loader {
            position: fixed;
            inset: 0;
            background: var(--bg);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.6s ease;
        }

        .loader svg {
            animation: spin 1.2s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Scrollbar */
        .nav-container::-webkit-scrollbar {
            width: 4px;
        }

        .nav-container::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.15);
            border-radius: 20px;
        }

        /* Extra stylish touches */
        .nav-link::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            width: 3px;
            height: 0;
            background: #fff;
            border-radius: 3px;
            transition: height 0.3s ease;
            transform: translateY(-50%);
        }

        .nav-link:hover::before,
        .nav-link.active::before {
            height: 22px;
        }
    </style>
</head>
<body>
    <div class="layout">

        <!-- SIDEBAR -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-inner">

                <!-- Logo -->
                <div class="logo-area">
                    <% if (logo == true) { %>
                        <img src="/assets/logo.png" class="logo-img" alt="Logo">
                    <% } %>
                    <span class="logo-text"><%= name %></span>
                </div>

                <!-- User -->
                <div class="user-section">
                    <img src="https://api.dicebear.com/9.x/thumbs/svg?seed=<%= user.username %>" class="user-avatar" alt="">
                    <div class="user-info">
                        <div class="user-name"><%= user.username %></div>
                        <div class="user-id"><%= user.userId.substring(0, 6) %></div>
                    </div>
                </div>

                <!-- Navigation -->
                <div class="nav-container">
                    <div class="active-bg" id="active-bg"></div>
                    <ul class="nav-list">

                        <!-- Main links -->
                        <li class="nav-item">
                            <a href="/instances" class="nav-link active">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><rect width="256" height="256" fill="none"/><path d="M220,169.09l-92,53.65L36,169.09A8,8,0,0,0,28,182.91l96,56a8,8,0,0,0,8.06,0l96-56A8,8,0,1,0,220,169.09Z"/><path d="M220,121.09l-92,53.65L36,121.09A8,8,0,0,0,28,134.91l96,56a8,8,0,0,0,8.06,0l96-56A8,8,0,1,0,220,121.09Z"/><path d="M28,86.91l96,56a8,8,0,0,0,8.06,0l96-56a8,8,0,0,0,0-13.82l-96-56a8,8,0,0,0-8.06,0l-96,56a8,8,0,0,0,0,13.82Z"/></svg>
                                <span class="nav-text"><%= req.translations.instances %></span>
                            </a>
                        </li>

                        <li class="nav-item">
                            <a href="/account" class="nav-link">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M10 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM3.465 14.493a1.23 1.23 0 0 0 .41 1.412A9.957 9.957 0 0 0 10 18c2.31 0 4.438-.784 6.131-2.1.43-.333.604-.903.408-1.41a7.002 7.002 0 0 0-13.074.003Z"/></svg>
                                <span class="nav-text"><%= req.translations.account %></span>
                            </a>
                        </li>

                        <!-- Plugins -->
                        <% plugins.forEach(plugin => { %>
                            <% if (plugin.sidebar) { %>
                                <% Object.entries(plugin.sidebar).forEach(([key, value]) => { %>
                                    <li class="nav-item">
                                        <a href="<%= value.url %>" class="nav-link">
                                            <% if (value.icon) { %>
                                                <span class="svg-icon" data-icon-url="<%= value.icon %>"></span>
                                            <% } else { %>
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M10 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM3.465 14.493a1.23 1.23 0 0 0 .41 1.412A9.957 9.957 0 0 0 10 18c2.31 0 4.438-.784 6.131-2.1.43-.333.604-.903.408-1.41a7.002 7.002 0 0 0-13.074.003Z"/></svg>
                                            <% } %>
                                            <span class="nav-text"><%= key %></span>
                                        </a>
                                    </li>
                                <% }); %>
                            <% } %>
                        <% }); %>

                        <!-- ADMIN SECTION -->
                        <% if (user.admin == true) { %>
                            <li>
                                <div class="admin-header">Admin Panel</div>
                            </li>

                            <li class="nav-item">
                                <a href="/admin/overview" class="nav-link">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><rect width="256" height="256" fill="none"/><path d="M224,120v96a8,8,0,0,1-8,8H160a8,8,0,0,1-8-8V164a4,4,0,0,0-4-4H108a4,4,0,0,0-4,4v52a8,8,0,0,1-8,8H40a8,8,0,0,1-8-8V120a16,16,0,0,1,4.69-11.31l80-80a16,16,0,0,1,22.62,0l80,80A16,16,0,0,1,224,120Z"/></svg>
                                    <span class="nav-text"><%= req.translations.overview %></span>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/admin/settings" class="nav-link">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><rect width="256" height="256" fill="none"/><path d="M237.94,107.21a8,8,0,0,0-3.89-5.4l-29.83-17-.12-33.62a8,8,0,0,0-2.83-6.08,111.91,111.91,0,0,0-36.72-20.67,8,8,0,0,0-6.46.59L128,41.85,97.88,25a8,8,0,0,0-6.47-.6A111.92,111.92,0,0,0,54.73,45.15a8,8,0,0,0-2.83,6.07l-.15,33.65-29.83,17a8,8,0,0,0-3.89,5.4,106.47,106.47,0,0,0,0,41.56,8,8,0,0,0,3.89,5.4l29.83,17,.12,33.63a8,8,0,0,0,2.83,6.08,111.91,111.91,0,0,0,36.72,20.67,8,8,0,0,0,6.46-.59L128,214.15,158.12,231a7.91,7.91,0,0,0,3.9,1,8.09,8.09,0,0,0,2.57-.42,112.1,112.1,0,0,0,36.68-20.73,8,8,0,0,0,2.83-6.07l.15-33.65,29.83-17a8,8,0,0,0,3.89-5.4A106.47,106.47,0,0,0,237.94,107.21ZM128,168a40,40,0,1,1,40-40A40,40,0,0,1,128,168Z"/></svg>
                                    <span class="nav-text"><%= req.translations.settings %></span>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/admin/analytics" class="nav-link">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><rect width="256" height="256" fill="none"/><path d="M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40ZM200,176a8,8,0,0,1,0,16H56a8,8,0,0,1-8-8V72a8,8,0,0,1,16,0v62.92l34.88-29.07a8,8,0,0,1,9.56-.51l43,28.69,43.41-36.18a8,8,0,0,1,10.24,12.3l-48,40a8,8,0,0,1-9.56.51l-43-28.69L64,155.75V176Z"/></svg>
                                    <span class="nav-text"><%= req.translations.analytics %></span>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/admin/users" class="nav-link">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M7 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM14.5 9a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5ZM1.615 16.428a1.224 1.224 0 0 1-.569-1.175 6.002 6.002 0 0 1 11.908 0c.058.467-.172.92-.57 1.174A9.953 9.953 0 0 1 7 18a9.953 9.953 0 0 1-5.385-1.572ZM14.5 16h-.106c.07-.297.088-.611.048-.933a7.47 7.47 0 0 0-1.588-3.755 4.502 4.502 0 0 1 5.874 2.636.818.818 0 0 1-.36.98A7.465 7.465 0 0 1 14.5 16Z"/></svg>
                                    <span class="nav-text"><%= req.translations.users %></span>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/admin/instances" class="nav-link">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><rect width="256" height="256" fill="none"/><path d="M24,80a8,8,0,0,1,4-6.91l96-56a8,8,0,0,1,8.06,0l96,56a8,8,0,0,1,0,13.82l-96,56a8,8,0,0,1-8.06,0l-96-56A8,8,0,0,1,24,80Zm196,41.09-92,53.65L36,121.09A8,8,0,0,0,28,134.91l96,56a8,8,0,0,0,8.06,0l96-56A8,8,0,1,0,220,121.09ZM232,192H216V176a8,8,0,0,0-16,0v16H184a8,8,0,0,0,0,16h16v16a8,8,0,0,0,16,0V208h16a8,8,0,0,0,0-16Zm-92,23.76-12,7L36,169.09A8,8,0,0,0,28,182.91l96,56a8,8,0,0,0,8.06,0l16-9.33A8,8,0,1,0,140,215.76Z"/></svg>
                                    <span class="nav-text"><%= req.translations.instances %></span>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/admin/nodes" class="nav-link">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><rect width="256" height="256" fill="none"/><path d="M208,40H48A16,16,0,0,0,32,56v48a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V56A16,16,0,0,0,208,40ZM180,92a12,12,0,1,1,12-12A12,12,0,0,1,180,92Z"/><path d="M208,136H48a16,16,0,0,0-16,16v48a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V152A16,16,0,0,0,208,136Zm-28,52a12,12,0,1,1,12-12A12,12,0,0,1,180,188Z"/></svg>
                                    <span class="nav-text"><%= req.translations.nodes %></span>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/admin/images" class="nav-link">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><rect width="256" height="256" fill="none"/><path d="M243.31,136,144,36.69A15.86,15.86,0,0,0,132.69,32H40a8,8,0,0,0-8,8v92.69A15.86,15.86,0,0,0,36.69,144L136,243.31a16,16,0,0,0,22.63,0l84.68-84.68a16,16,0,0,0,0-22.63ZM84,96A12,12,0,1,1,96,84,12,12,0,0,1,84,96Z"/></svg>
                                    <span class="nav-text"><%= req.translations.images %></span>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/admin/apikeys" class="nav-link">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><rect width="256" height="256" fill="none"/><path d="M216.57,39.43A80,80,0,0,0,83.91,120.78L28.69,176A15.86,15.86,0,0,0,24,187.31V216a16,16,0,0,0,16,16H72a8,8,0,0,0,8-8V208H96a8,8,0,0,0,8-8V184h16a8,8,0,0,0,5.66-2.34l9.56-9.57A79.73,79.73,0,0,0,160,176h.1A80,80,0,0,0,216.57,39.43ZM180,92a16,16,0,1,1,16-16A16,16,0,0,1,180,92Z"/></svg>
                                    <span class="nav-text"><%= req.translations.APIKeys %></span>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/admin/auditlogs" class="nav-link">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><rect width="256" height="256" fill="none"/><path d="M220.8,169.6A8,8,0,0,0,216,168h-8V64a32,32,0,0,0-32-32H40A32,32,0,0,0,8,64C8,77.61,18.05,85.54,19.2,86.4h0A7.89,7.89,0,0,0,24,88a8,8,0,0,0,4.87-14.33h0C28.83,73.62,24,69.74,24,64a16,16,0,0,1,32,0V192a32,32,0,0,0,32,32H200a32,32,0,0,0,32-32C232,178.39,222,170.46,220.8,169.6ZM104,96h64a8,8,0,0,1,0,16H104a8,8,0,0,1,0-16Zm-8,40a8,8,0,0,1,8-8h64a8,8,0,0,1,0,16H104A8,8,0,0,1,96,136Zm104,72H107.71A31.82,31.82,0,0,0,112,192a26.92,26.92,0,0,0-1.21-8h102a12.58,12.58,0,0,1,3.23,8A16,16,0,0,1,200,208Z"/></svg>
                                    <span class="nav-text"><%= req.translations.auditLogs %></span>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a href="/admin/plugins" class="nav-link">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"><rect width="256" height="256" fill="none"/><path d="M165.78,224H208a16,16,0,0,0,16-16V170.35A8,8,0,0,0,212.94,163a23.37,23.37,0,0,1-8.94,1.77c-13.23,0-24-11.1-24-24.73s10.77-24.73,24-24.73a23.37,23.37,0,0,1,8.94,1.77A8,8,0,0,0,224,109.65V72a16,16,0,0,0-16-16H171.78a35.36,35.36,0,0,0,.22-4,36,36,0,0,0-72,0,35.36,35.36,0,0,0,.22,4H64A16,16,0,0,0,48,72v32.22a35.36,35.36,0,0,0-4-.22,36,36,0,0,0,0,72,35.36,35.36,0,0,0,4-.22V208a16,16,0,0,0,16,16h42.22"/></svg>
                                    <span class="nav-text"><%= req.translations.plugins %></span>
                                </a>
                            </li>
                        <% } %>

                    </ul>
                </div>

                <!-- Logout -->
                <a href="/auth/logout" class="logout">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.8" stroke="currentColor" style="width:20px;height:20px">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15" />
                    </svg>
                    <span class="nav-text"><%= req.translations.signOut %></span>
                </a>

            </div>
        </div>

        <!-- MAIN AREA -->
        <div class="main-area">

            <!-- HEADER -->
            <header class="header">
                <!-- Sidebar toggle (visible only on large screens) -->
                <button onclick="document.getElementById('sidebar').classList.toggle('collapsed')" class="sidebar-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.2" stroke="currentColor" style="width:22px;height:22px">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                    </svg>
                </button>

                <!-- Search -->
                <div class="search-box">
                    <div class="search-inner">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M21 21l-6-6m2-5a7 7 0 01-14 0 7 7 0 0114 0z" />
                        </svg>
                        <input type="text" id="searchInput" class="search-input" placeholder="<%= req.translations.search %>">
                    </div>
                </div>

                <!-- Profile -->
                <div class="profile-area">
                    <button class="profile-btn">
                        <img src="https://api.dicebear.com/9.x/thumbs/svg?seed=<%= user.username %>" class="profile-avatar" alt="">
                        <div>
                            <div class="profile-name"><%= user.username %></div>
                            <div class="profile-id">(<%= user.userId.substring(0, 6) %>)</div>
                        </div>
                    </button>

                    <!-- Language Dropdown -->
                    <div class="profile-dropdown">
                        <div class="dropdown-inner">
                            <label class="lang-label">Language</label>
                            <select class="lang-select">
                                <% languages.forEach(function(language) { %>
                                    <option value="<%= language %>" <%= (req.cookies.lang ? req.cookies.lang : 'en') === language ? 'selected' : '' %>>
                                        <%= req.translations[language] %>
                                    </option>
                                <% }); %>
                            </select>
                        </div>
                    </div>
                </div>
            </header>

            <!-- CONTENT AREA (placeholder - your page content goes here) -->
            <div style="flex:1;overflow:auto;padding:32px;background:var(--bg);">
                <!-- Your actual page content will be injected here by your backend -->
                <h1 style="font-size:28px;font-weight:700;margin-bottom:8px;">Welcome back, <%= user.username %> ðŸ‘‹</h1>
                <p style="color:var(--text-muted);">Choose a section from the sidebar to get started.</p>
            </div>

        </div>
    </div>

    <!-- LOADER -->
    <div class="loader" id="loader">
        <svg xmlns="http://www.w3.org/2000/svg" width="42" height="42" viewBox="0 0 27 27" fill="#666">
            <path d="M18.696,10.5c-0.275-0.479-0.113-1.09,0.365-1.367l4.759-2.751c0.482-0.273,1.095-0.11,1.37,0.368 c0.276,0.479,0.115,1.092-0.364,1.364l-4.764,2.751C19.583,11.141,18.973,10.977,18.696,10.5z"/>
            <path d="M16.133,6.938l2.75-4.765c0.276-0.478,0.889-0.643,1.367-0.366c0.479,0.276,0.641,0.886,0.365,1.366l-2.748,4.762 C17.591,8.415,16.979,8.58,16.5,8.303C16.021,8.027,15.856,7.414,16.133,6.938z"/>
            <path d="M13.499,7.5c-0.552,0-1-0.448-1-1.001V1c0-0.554,0.448-1,1-1c0.554,0,1.003,0.447,1.003,1v5.499 C14.5,7.053,14.053,7.5,13.499,7.5z"/>
            <path d="M8.303,10.5c-0.277,0.477-0.888,0.641-1.365,0.365L2.175,8.114C1.697,7.842,1.532,7.229,1.808,6.75 c0.277-0.479,0.89-0.642,1.367-0.368l4.762,2.751C8.416,9.41,8.58,10.021,8.303,10.5z"/>
            <path d="M9.133,7.937l-2.75-4.763c-0.276-0.48-0.111-1.09,0.365-1.366c0.479-0.277,1.09-0.114,1.367,0.366l2.75,4.765 c0.274,0.476,0.112,1.088-0.367,1.364C10.021,8.581,9.409,8.415,9.133,7.937z"/>
            <path d="M6.499,14.5H1c-0.554,0-1-0.448-1-1c0-0.554,0.447-1.001,1-1.001h5.499c0.552,0,1.001,0.448,1.001,1.001 C7.5,14.052,7.052,14.5,6.499,14.5z"/>
            <path d="M8.303,16.502c0.277,0.478,0.113,1.088-0.365,1.366l-4.762,2.749c-0.478,0.273-1.091,0.112-1.368-0.366 c-0.276-0.479-0.111-1.089,0.367-1.368l4.762-2.748C7.415,15.856,8.026,16.021,8.303,16.502z"/>
            <path d="M10.866,20.062l-2.75,4.767c-0.277,0.475-0.89,0.639-1.367,0.362c-0.477-0.277-0.642-0.886-0.365-1.365l2.75-4.764 c0.277-0.477,0.888-0.638,1.366-0.365C10.978,18.974,11.141,19.585,10.866,20.062z"/>
            <path d="M13.499,19.502c0.554,0,1.003,0.448,1.003,1.002v5.498c0,0.55-0.448,0.999-1.003,0.999c-0.552,0-1-0.447-1-0.999v-5.498 C12.499,19.95,12.946,19.502,13.499,19.502z"/>
            <path d="M17.867,19.062l2.748,4.764c0.275,0.479,0.113,1.088-0.365,1.365c-0.479,0.276-1.091,0.112-1.367-0.362l-2.75-4.767 c-0.276-0.477-0.111-1.088,0.367-1.365C16.979,18.424,17.591,18.585,17.867,19.062z"/>
            <path d="M18.696,16.502c0.276-0.48,0.887-0.646,1.365-0.367l4.765,2.748c0.479,0.279,0.64,0.889,0.364,1.368 c-0.275,0.479-0.888,0.64-1.37,0.366l-4.759-2.749C18.583,17.59,18.421,16.979,18.696,16.502z"/>
            <path d="M25.998,12.499h-5.501c-0.552,0-1.001,0.448-1.001,1.001c0,0.552,0.447,1,1.001,1h5.501c0.554,0,1.002-0.448,1.002-1 C27,12.946,26.552,12.499,25.998,12.499z"/>
        </svg>
    </div>

<script>
   document.addEventListener('DOMContentLoaded', () => {
      const loader = document.getElementById('loader');
      const content = document.getElementById('content');

      setTimeout(() => {
         loader.classList.add('opacity-0');
         content.classList.add('opacity-100');
      
         setTimeout(() => {
            loader.style.display = 'none';
         }, 400);
      }, 300);
   });
</script>

<script>
   document.addEventListener('DOMContentLoaded', () => {
      const sidebar = document.getElementById('pc-sidebar');
      const sidebar2 = document.getElementById('pc-sidebar2');
      const colcont = document.getElementById('colcont');

      if ('<%= theme["sidebar-direction"] %>' === 'right') {
         sidebar.classList.add('right-0');
         colcont.classList.add('colcontextream');
         colcont.classList.add('colcont-right');
         sidebar2.classList.remove('rounded-r-3xl', 'rounded-l-lg');
         sidebar2.classList.add('rounded-r-lg', 'rounded-l-3xl');
      } else {
         sidebar.classList.add('left-0');
      }
   });
</script>

<script>
                              document.addEventListener("DOMContentLoaded", function() {
                                  document.querySelectorAll('.svg-icon').forEach(function(span) {
                                      const url = span.getAttribute('data-icon-url');
                          
                                      fetch(url)
                                          .then(response => {
                                              if (!response.ok) {
                                                  throw new Error('Network response was not ok');
                                              } else if (response.status !== 200) {
                                                  throw new Error(`Request failed with status ${response.status}`);
                                              } else if (!response.text().includes('<svg')) {
                                                 throw new Error('Response does not contain an SVG');
                                              }
                                              return response.text();
                                          })
                                          .then(svgContent => {
                                              span.innerHTML = svgContent;
                                          })
                                          .catch(error => {
                                              console.error('Error on Loading the SVG:', error);
                                          });
                                  });
                              });
                          </script>
                          
                           <script>
   function toggleDropdown() {
     const dropdownMenu = document.getElementById('dropdown-menu');
     dropdownMenu.classList.toggle('hidden');
     if (!dropdownMenu.classList.contains('hidden')) {
       setTimeout(() => {
         dropdownMenu.style.transform = 'scale(1)';
         dropdownMenu.style.opacity = '1';
       }, 10);
     } else {
       dropdownMenu.style.transform = 'scale(0.95)';
       dropdownMenu.style.opacity = '0';
     }
   }

   window.addEventListener('click', function(e) {
     const userMenuButton = document.getElementById('user-menu-button');
     const dropdownMenu = document.getElementById('dropdown-menu');
     if (!userMenuButton.contains(e.target) && !dropdownMenu.contains(e.target)) {
       dropdownMenu.classList.add('hidden');
       dropdownMenu.style.transform = 'scale(0.95)';
       dropdownMenu.style.opacity = '0';
     }
   });
 </script>
 
 <script>
         document.addEventListener('DOMContentLoaded', function() {
           const navLinks = document.querySelectorAll('.nav-link');
           const activeBackground = document.getElementById('active-background');
           const contentSection = document.getElementById('content');
           let isAnimating = false;
           let currentActiveLink = null;
         
           function getCookie(name) {
             const value = `; ${document.cookie}`;
             const parts = value.split(`; ${name}=`);
             if (parts.length === 2) return parts.pop().split(';').shift();
           }
         
           function setCookie(name, value, days) {
             let expires = '';
             if (days) {
               const date = new Date();
               date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
               expires = `; expires=${date.toUTCString()}`;
             }
             document.cookie = `${name}=${value || ''}${expires}; path=/`;
           }
         
           function updateActiveBackground(link, instant = false) {
             if (!link) return;
             
             const linkRect = link.getBoundingClientRect();
             const navRect = link.closest('ul').getBoundingClientRect();
             const topOffset = linkRect.top - navRect.top + link.closest('ul').scrollTop;
         
             if (instant) {
               activeBackground.style.transition = 'none';
             }
             
             activeBackground.style.height = `${linkRect.height}px`;
             activeBackground.style.transform = `translateY(${topOffset}px)`;
         
             if (instant) {
               // Force a reflow
               void activeBackground.offsetWidth;
               activeBackground.style.transition = 'transform 0.3s ease, height 0.3s ease';
             }
         
             setCookie('lastActiveLink', link.id, 7);
             currentActiveLink = link;
           }
         
           function updateActiveLink(currentPath) {
             let foundActive = false;
             navLinks.forEach((link) => {
               let currentpathx2 = currentPath.replace('instance/', 'instances');
               if (currentpathx2.startsWith(link.getAttribute('href'))) {
                 link.classList.add('active');
                 updateActiveBackground(link, true);
                 foundActive = true;
               } else {
                 link.classList.remove('active');
               }
             });
         
             if (!foundActive) {
               activeBackground.style.transform = 'translateY(0)';
               activeBackground.style.height = '0px';
             }
           }
         
           // Appliquer immÃ©diatement au chargement de la page
           updateActiveLink(window.location.pathname);
         
           function animatePageTransition(href) {
             if (isAnimating) return;
             isAnimating = true;
         
             contentSection.style.opacity = '0';
             contentSection.style.transform = 'translateX(-20px)';
             window.location.href = href;
           }
         
           navLinks.forEach(link => {
             link.addEventListener('click', (e) => {
               e.preventDefault();
               const href = link.getAttribute('href');
               updateActiveLink(href);
               animatePageTransition(href);
             });
           });
         
           window.addEventListener('popstate', () => {
             updateActiveLink(window.location.pathname);
           });
         });


         document.addEventListener('DOMContentLoaded', () => {
            const sidebar = document.querySelector('.sidebar');
            const toggleButton = document.getElementById('sidebar-toggle');
            const colcont = document.getElementById('colcont');

            function setCookie(name, value, days) {
               const date = new Date();
               date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
               const expires = "expires=" + date.toUTCString();
               document.cookie = name + "=" + value + ";" + expires + ";path=/";
            }
            function getCookie(name) {
               const nameEQ = name + "=";
               const ca = document.cookie.split(';');
               for(let i = 0; i < ca.length; i++) {
                  let c = ca[i];
                  while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                  if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
               }
               return null;
            }
            const sidebarState = getCookie('sidebar-collapsed');
            if (sidebarState === 'true') {
               sidebar.classList.add('collapsed');
               colcont.classList.add('colcont');
            } else {
               sidebar.classList.remove('collapsed');
               colcont.classList.remove('colcont');
            }
            toggleButton.addEventListener('click', () => {
               sidebar.classList.toggle('collapsed');
               colcont.classList.toggle('colcont');
               const isCollapsed = sidebar.classList.contains('collapsed');
               setCookie('sidebar-collapsed', isCollapsed, 7);
            });

            const mobileToggleButton = document.getElementById('mobile-sidebar-toggle');
            if (mobileToggleButton) {
               mobileToggleButton.addEventListener('click', () => {
                  sidebar.classList.toggle('open');
                  if (sidebar.classList.contains('open')) {
                     mobileToggleButton.classList.add('right-4');
                     mobileToggleButton.classList.remove('left-4');
                  } else {
                     mobileToggleButton.classList.add('left-4');
                     mobileToggleButton.classList.remove('right-4');
                  }
               });
            }
         });
         </script>         
 
 <script src="/javascript/language/index.js"></script>
 <script src="/javascript/search/index.js"></script>
