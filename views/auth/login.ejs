<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= name %> - Login</title>
  <link href="/css/ks-panel.css" rel="stylesheet">

<style>
/* ================= BODY ================= */
body {
  /* Background image with dark overlay */
  background:
    linear-gradient(rgba(0, 0, 0, 0.45), rgba(0, 0, 0, 0.45)),
    url('path-to-your-image.jpg') center/cover no-repeat;

  color: var(--text);
  font-family: var(--font-family);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100dvh;
  user-select: none;
  margin: var(--margin-body);
}

/* ================= CARD ================= */
.card {
  padding: var(--card-padding);
  width: 100%;
  max-width: 400px;
  backdrop-filter: blur(var(--backdrop-blur));
  background: rgba(0, 0, 0, 0.4);
  border-radius: var(--card-radius);
  display: flex;
  flex-direction: column;
  gap: var(--gap);
  box-shadow: 0 10px 30px rgba(0,0,0,0.4);
}

.card h2 {
  font-size: var(--h2-size);
  margin-bottom: 8px;
  font-weight: 800;
}

.card p {
  color: var(--muted);
  font-size: var(--p-size);
  margin-bottom: 15px;
}

/* ================= INPUTS ================= */
.input-label {
  display: block;
  margin-bottom: 6px;
  font-size: var(--label-size);
  font-weight: var(--label-font-weight);
}

.input-field {
  width: 100%;
  padding: var(--input-padding);
  border-radius: var(--input-radius);
  border: 1px solid var(--border);
  background: var(--soft);
  color: var(--text);
  transition: all var(--transition);
  font-size: var(--p-size);
  margin-bottom: 8px;
}

.input-field:focus {
  border-color: var(--accent);
  outline: none;
}

/* ================= CHECKBOX ================= */
.checkbox {
  accent-color: blue;
  margin-right: 8px;
}

/* ================= LINKS ================= */
.link {
  color: var(--accent);
  font-size: var(--link-size);
  text-decoration: none;
  transition: color 0.3s;
  display: inline-block;
  margin-bottom: 8px;
}

.link:hover {
  color: var(--accent-glow);
}

/* ================= BUTTON ================= */
.btn {
  padding: var(--btn-padding);
  border-radius: var(--btn-radius);
  border: none;
  background: var(--accent);
  color: #000;
  width: 100%;
  font-weight: var(--btn-font-weight);
  cursor: pointer;
  transition: all var(--transition);
  box-shadow: var(--btn-shadow);
}

.btn:hover {
  transform: scale(1.03);
}

/* ================= RESPONSIVE ================= */
@media (max-width: 480px) {
  .card {
    padding: var(--card-padding-mobile);
  }
}
</style>
</head>

<body>

<div class="card">
  <div>
    <h2>Sign in to <%= name %></h2>
    <p>Please enter your account credentials below.</p>
  </div>

  <form id="login-form" onsubmit="event.preventDefault(); submitForm();">
    
    <div>
      <input class="input-field"
             placeholder="Username or Email"
             id="username"
             autocomplete="username"
             required>
    </div>

    <div>
      <input class="input-field"
             placeholder="Password"
             id="password"
             name="password"
             type="password"
             autocomplete="current-password"
             required>
    </div>

    <div style="display: flex; align-items: center; gap: 6px;">
      <input class="checkbox"
             id="remember-me"
             name="remember-me"
             type="checkbox">
      <span class="input-label">Remember me</span>
    </div>

    <div>
      <a class="link" href="/auth/reset-password">Forgot your password?</a>
    </div>

    <div>
      <button class="btn" type="button" onclick="submitForm()">Sign in</button>
    </div>

  </form>
</div>

<script>
document.getElementById('login-form').addEventListener('keypress', function(event) {
  if (event.key === 'Enter') {
    event.preventDefault();
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value.trim();

    if (username !== "" && password === "") {
      document.getElementById("password").focus();
    } else {
      submitForm();
    }
  }
});

async function submitForm() {
  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value.trim();

  if (username === "" || password === "") {
    document.location.href = `/auth/login?err=InvalidCredentials&state=failed`;
    return;
  }

  const encodedUsername = encodeURIComponent(username);
  const encodedPassword = encodeURIComponent(password);

  document.location.href = `/auth/login?username=${encodedUsername}&password=${encodedPassword}`;
}
</script>

</body>
</html>
